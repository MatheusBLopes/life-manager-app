{% extends 'global/base.html' %}

{% block title %}Habit Tracker | {% endblock title %}

{% block content %}

<div class="container-fluid d-flex align-items-left border-top border-bottom p-3">
    <a href="{% url 'habit_tracker:habit_tracker' week.present_week present_year %}"
        class="text-center btn btn-primary me-1">
        Today
    </a>
    <a href="{% url 'habit_tracker:create_habit' %}" class="text-center btn btn-primary">
        Create Habit
    </a>
</div>


<div class="row h-100 mt-4">
    <div id="custom-narrow-col" class="col d-flex align-items-center justify-content-center p-0">
        <a href="{% url 'habit_tracker:habit_tracker' week.previous_week previous_year %}"
            class="w-100 h-100 d-flex align-items-center justify-content-center">
            <i class="bi bi-caret-left-fill fs-4 text-white"></i>
        </a>
    </div>

    {% for day in days %}
    <div id="separator" class="border-end col"></div>

    <div class="col">
        <div class="d-flex flex-column justify-content-center">
            <h3 class="text-center">{{day.day_name}}</h3>
            <p class="text-center">{{day.date}}</p>
            <p class="badge {% if day.percentage_completed > 90 %} bg-success {% else %} bg-danger {% endif %}">{{ day.percentage_completed }}%</p>
        </div>

        <!-- Habits Section -->
        <div class="list-group">
            {% for habit in day.habits %}
            <form method="post"
                action="{% url 'habit_tracker:mark_completed' week.current_week current_year day.raw_date %}">
                {% csrf_token %}
                <input type="hidden" name="habit_id" value="{{ habit.id }}">
                <div class="list-group-item list-group-item-action d-flex align-items-center border-bottom-0">
                    {{ habit.name }}
                    <div class="ms-auto">
                        {% if habit.is_completed %}
                        <button type="submit" name="success" value="False" class="btn">
                            <i class="bi bi-x"></i>
                        </button>
                        {% else %}
                        <button type="submit" name="success" value="True" class="btn">
                            <i class="bi bi-check"></i>
                        </button>
                        {% endif %}
                    </div>
                </div>
                <div
                    class="list-group-item-bottom-border border-5 {% if habit.is_completed %} border-bottom border-success {% else %} border-bottom border-danger {% endif %}">
                </div>
            </form>
            {% endfor %}
        </div>
    </div>

    {% if day.day_name == "Saturday" %}
    <div id="separator" class="border-end col"></div>
    {% endif %}
    {% endfor %}

    <div id="custom-narrow-col" class="col d-flex align-items-center justify-content-center p-0">
        <a href="{% url 'habit_tracker:habit_tracker' week.next_week next_year %}"
            class="w-100 h-100 d-flex align-items-center justify-content-center">
            <i class="bi bi-caret-right-fill fs-4 text-white"></i>
        </a>
    </div>

</div>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                ...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

{% endblock content %}